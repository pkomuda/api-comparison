syntax = "proto3";

import "google/protobuf/empty.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_package = "pl.dmcs.grpc";
option java_outer_classname = "AccountGrpcProto";

package account;

service Account {
    rpc Login (LoginRequest) returns (google.protobuf.StringValue);
    rpc Register (RegisterRequest) returns (google.protobuf.Empty);
    rpc AddAccount (AddAccountRequest) returns (google.protobuf.Empty);
    rpc GetAccount (google.protobuf.StringValue) returns (AccountDetails);
    rpc GetOwnAccount (google.protobuf.Empty) returns (AccountDetails);
    rpc GetAllAccounts (google.protobuf.Empty) returns (AccountList);
    rpc GetAccounts (GetAccountsRequest) returns (AccountPages);
    rpc EditAccount (AccountDetails) returns (google.protobuf.Empty);
    rpc EditOwnAccount (AccountDetails) returns (google.protobuf.Empty);
    rpc ChangePassword (ChangePasswordRequest) returns (google.protobuf.Empty);
    rpc DeleteAccount (google.protobuf.StringValue) returns (google.protobuf.Empty);
}

message LoginRequest {
    string username = 1;
    string password = 2;
}

message RegisterRequest {
    string username = 1;
    string password = 2;
    string confirmPassword = 3;
    string email = 4;
    string firstName = 5;
    string lastName = 6;
}

message AddAccountRequest {
    string username = 1;
    string password = 2;
    string confirmPassword = 3;
    string email = 4;
    string firstName = 5;
    string lastName = 6;
    bool active = 7;
    repeated string accessLevels = 8;
}

message AccountDetails {
    string username = 1;
    string email = 2;
    string firstName = 3;
    string lastName = 4;
    bool active = 5;
    repeated string accessLevels = 6;
}

message AccountList {
    repeated AccountDetails accounts = 1;
}

message GetAccountsRequest {
    string query = 1;
    string sort = 2;
    string dir = 3;
    uint32 page = 4;
    uint32 size = 5;
}

message AccountPages {
    repeated AccountDetails content = 1;
    uint64 totalSize = 2;
}

message ChangePasswordRequest {
    string username = 1;
    string previousPassword = 2;
    string password = 3;
    string confirmPassword = 4;
}
